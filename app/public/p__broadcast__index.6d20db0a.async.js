(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[4],{Iqqo:function(e,t,a){"use strict";var l=a("g09b");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a("T2oS");var n=l(a("W9HT"));a("IzEo");var r=l(a("bx4M")),s=l(a("jehZ"));a("5NDa");var u=l(a("5rEg"));a("y8nQ");var d=l(a("Vl3Y"));a("OaEy");var i=l(a("2fM7"));a("2qtc");var o=l(a("kLXV"));a("Mwp2");var p=l(a("VXEj"));a("+L6B");var f=l(a("2/Rp"));a("miYZ");var c=l(a("tsqr")),m=l(a("q1tI")),h=a("mW+d");class E extends m.default.Component{constructor(e){super(e),this.handleSubmit=(e=>{e.preventDefault(),this.props.form.validateFields(["content","duration","frequency","srv"],(e,t)=>{e||(console.log(t),c.default.info("\u5f53\u524d\u529f\u80fd\u5c1a\u672a\u5b9e\u73b0"))})}),this.handleAnntplSubmit=(e=>{e.preventDefault(),this.props.form.validateFields(["anntpl"],(e,t)=>{e||(this.setState({loading:!0}),(0,h.create)(t).then(e=>{this.props.form.setFieldsValue({anntpl:""}),0===e.code?(c.default.success("\u63d0\u4ea4\u6210\u529f"),this.fetchAnntpls()):c.default.error("\u64cd\u4f5c\u5931\u8d25"),this.setState({loading:!1})}))})}),this.fetchAnntpls=(()=>{this.setState({loading:!0}),(0,h.listTpl)().then(e=>{0===e.code&&this.setState({tpls:e.payload,loading:!1})})}),this.showTplList=(()=>{this.fetchAnntpls(),this.setState({showTplListModal:!0})}),this.deleteAnnTpl=(e=>{(0,h.delTpl)(e).then(e=>{this.fetchAnntpls(),c.default.success("\u64cd\u4f5c\u6210\u529f")})}),this.onAnntplSelect=(e=>{var t=this.props.form,a=t.getFieldValue("content");t.setFieldsValue({content:(a||"")+e})}),this.state={tpls:[],showTplListModal:!1,loadingTplList:!1,loading:!1}}componentDidMount(){this.fetchAnntpls()}render(){var e=this.props.form.getFieldDecorator,t={labelCol:{xs:{span:24},sm:{span:6}},wrapperCol:{xs:{span:24},sm:{span:10}}},a={wrapperCol:{xs:{span:24,offset:0},sm:{span:16,offset:6}}};return m.default.createElement(n.default,{spinning:this.state.loading,tip:"\u52a0\u8f7d\u4e2d..."},m.default.createElement(o.default,{width:750,onCancel:()=>this.setState({showTplListModal:!1}),footer:null,destroyOnClose:!0,visible:this.state.showTplListModal},m.default.createElement(p.default,{loading:this.state.loadingTplList,itemLayout:"horizontal",dataSource:this.state.tpls,renderItem:e=>m.default.createElement(p.default.Item,{key:e.id},m.default.createElement("div",null,m.default.createElement(f.default,{onClick:()=>this.deleteAnnTpl(e.id),type:"danger",style:{marginRight:10}},"\u5220\u9664"),e.content))})),m.default.createElement(r.default,{title:"\u53d1\u5e03\u5e7f\u64ad"},m.default.createElement(d.default,(0,s.default)({},t,{style:{marginTop:50,marginBottom:50},onSubmit:this.handleSubmit}),m.default.createElement(d.default.Item,{label:"\u4f7f\u7528\u8bcd\u6761"},m.default.createElement(i.default,{allowClear:!0,onSelect:(e,t)=>this.onAnntplSelect(e),placeholder:"\u4e0b\u62c9\u4f7f\u7528\u8bcd\u6761"},this.state.tpls.map(e=>m.default.createElement(i.default.Option,{key:e.id,value:e.content},e.content)))),m.default.createElement(d.default.Item,{label:"\u5e7f\u64ad\u5185\u5bb9"},e("content",{rules:[{required:!0,message:"\u5e7f\u64ad\u5185\u5bb9\u4e0d\u80fd\u4e3a\u7a7a"}]})(m.default.createElement(u.default.TextArea,{placeholder:"\u8f93\u5165\u5e7f\u64ad\u5185\u5bb9",rows:6}))),m.default.createElement(d.default.Item,{label:"\u6301\u7eed\u65f6\u95f4\uff08\u79d2\uff09"},e("duration",{rules:[{required:!0,message:"\u6301\u7eed\u65f6\u95f4\u4e0d\u80fd\u4e3a\u7a7a"}]})(m.default.createElement(u.default,{type:"number"}))),m.default.createElement(d.default.Item,{label:"\u9891\u7387\uff08\u79d2\uff09"},e("frequency",{rules:[{required:!0,message:"\u9891\u7387\u4e0d\u80fd\u4e3a\u7a7a"}]})(m.default.createElement(u.default,{type:"number"}))),m.default.createElement(d.default.Item,{label:"\u670d\u52a1\u5668"},e("srv",{rules:[{required:!0,message:"\u81f3\u5c11\u9700\u8981\u9009\u62e9\u4e00\u4e2a\u670d\u52a1\u5668"}]})(m.default.createElement(i.default,{mode:"multiple",placeholder:"\u8bf7\u9009\u62e9\u670d\u52a1\u5668"},m.default.createElement(i.default.Option,{value:"1"},"\u670d\u52a1\u56681"),m.default.createElement(i.default.Option,{value:"2"},"\u670d\u52a1\u56682"),m.default.createElement(i.default.Option,{value:"3"},"\u670d\u52a1\u56683"),m.default.createElement(i.default.Option,{value:"4"},"\u670d\u52a1\u56684")))),m.default.createElement(d.default.Item,a,m.default.createElement(f.default,{type:"primary",htmlType:"submit"},"\u63d0\u4ea4")))),m.default.createElement(r.default,{title:"\u6dfb\u52a0/\u5220\u9664\u8bcd\u6761",style:{marginTop:50}},m.default.createElement(d.default,(0,s.default)({},t,{onSubmit:this.handleAnntplSubmit}),m.default.createElement(d.default.Item,{label:"\u8bcd\u6761\u5185\u5bb9"},e("anntpl",{rules:[{required:!0,message:"\u8bcd\u6761\u5185\u5bb9\u4e0d\u80fd\u4e3a\u7a7a"}]})(m.default.createElement(u.default.TextArea,{placeholder:"\u8f93\u5165\u8bcd\u6761\u5185\u5bb9",rows:5}))),m.default.createElement(d.default.Item,a,m.default.createElement(f.default,{type:"primary",htmlType:"submit"},"\u63d0\u4ea4"),m.default.createElement(f.default,{style:{marginLeft:10},type:"danger",onClick:this.showTplList},"\u8bcd\u6761\u5220\u9664")))))}}var v=d.default.create()(E);t.default=v},"mW+d":function(e,t,a){"use strict";var l=a("g09b");Object.defineProperty(t,"__esModule",{value:!0}),t.delTpl=u,t.create=i,t.listTpl=p;var n=l(a("d6i3")),r=l(a("1l/V")),s=a("+/AZ");function u(e){return d.apply(this,arguments)}function d(){return d=(0,r.default)(n.default.mark(function e(t){return n.default.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,s.del)(`/api/broadcast/tpl/${t}`));case 1:case"end":return e.stop()}},e)})),d.apply(this,arguments)}function i(e){return o.apply(this,arguments)}function o(){return o=(0,r.default)(n.default.mark(function e(t){var a;return n.default.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return a=t.anntpl,e.abrupt("return",(0,s.post)("/api/broadcast/tpl/add",{content:a}));case 2:case"end":return e.stop()}},e)})),o.apply(this,arguments)}function p(){return f.apply(this,arguments)}function f(){return f=(0,r.default)(n.default.mark(function e(){return n.default.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",(0,s.get)("/api/broadcast/tpl/list"));case 1:case"end":return e.stop()}},e)})),f.apply(this,arguments)}}}]);